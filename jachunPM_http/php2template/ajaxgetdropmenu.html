{{js_set "productID" $productID}}
{{js_set "module" $module}}
{{js_set "method" $method}}
{{js_set "extra" $extra}}
<?php
$iCharges = 0;
$others   = 0;
$closeds  = 0;
$productNames = array();
foreach($products as $product)
{
    if($product->status == 'normal' and $product->PO == $this->app->user->account) $iCharges++;
    if($product->status == 'normal' and !($product->PO == $this->app->user->account)) $others++;
    if($product->status == 'closed') $closeds++;
    $productNames[] = $product->name;
}
$productsPinYin = common::convert2Pinyin($productNames);
$myProductsHtml     = '';
$normalProductsHtml = '';
$closedProductsHtml = '';

foreach($products as $product)
{
    if($product->status == 'normal' and $product->PO == $this->app->user->account)
    {
        if($product->type != 'platform' && $module == 'branch' && $method == 'manage')
        {
            $myProductsHtml .= html_a sprintf $link $productID "<i class='icon icon-cube'></i> " . $product->name "" "class='text-important' title='{$product->name}' data-key='" . zget($productsPinYin, $product->name, '' . "'");
        }
        else
        {
            $myProductsHtml .= html_a sprintf $link $product->id "<i class='icon icon-cube'></i> " . $product->name "" "class='text-important' title='{$product->name}' data-key='" . zget($productsPinYin, $product->name, '' . "'");
        }
    }
    else if($product->status == 'normal' and !($product->PO == $this->app->user->account))
    {
        if($product->type != 'platform' && $module == 'branch' && $method == 'manage')
        {
            $normalProductsHtml .= html_a sprintf $link $productID "<i class='icon icon-cube'></i> " . $product->name "" "title='{$product->name}' data-key='" . zget($productsPinYin, $product->name, '' . "'");
        }
        else
        {
            $normalProductsHtml .= html_a sprintf $link $product->id "<i class='icon icon-cube'></i> " . $product->name "" "title='{$product->name}' data-key='" . zget($productsPinYin, $product->name, '' . "'");
        }
    }
    else if($product->status == 'closed')
    {

        if($product->type != 'platform' && $module == 'branch' && $method == 'manage')
        {
            $closedProductsHtml .= html_a sprintf $link $productID "<i class='icon icon-cube'></i> " . $product->name "" "title='{$product->name}' class='closed' data-key='" . zget($productsPinYin, $product->name, '' . "'");
        }
        else
        {
            $closedProductsHtml .= html_a sprintf $link $product->id "<i class='icon icon-cube'></i> " . $product->name "" "title='{$product->name}' class='closed' data-key='" . zget($productsPinYin, $product->name, '' . "'");
        }
    }
}
?>
<div class="table-row">
  <div class="table-col col-left">
    <div class='list-group'>
    <?php
    if(!empty($myProductsHtml))
    {
        "<div class='heading'>{.Lang.product.mine}</div>";
        $myProductsHtml;
        if(!empty($myProductsHtml))
        {
            "<div class='heading'>{.Lang.product.other}</div>";
        }
    }
    $normalProductsHtml;
    ?>
    </div>
    <div class="col-footer">
      {{html_a helper::createLink('product' 'all') '<i class="icon icon-cards-view muted"></i> ' . .Lang.product.all }}
      <a class='pull-right toggle-right-col'>{{.Lang.product.closed}}<i class='icon icon-angle-right'></i></a>
    </div>
  </div>
  <div class="table-col col-right">
   <div class='list-group'>
    <?php
    $closedProductsHtml;
    ?>
    </div>
  </div>
</div>
